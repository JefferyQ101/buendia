#!/bin/bash

set -e
cd $(dirname $0)
source remote-execution.sh
password=$1

if [ "$1" == "-h" -o ! -n "$password" ]; then
  echo "Usage: $0 <new-admin-password>"
  echo
  echo "Installs all necessary Debian packages on the target Edison, setting"
  echo "all the application administrator passwords to <new-admin-password>."
  exit 1
fi

echo
echo "Installing Debian packages (takes ~15 minutes)..."
echo

run_script_in_debian debian/install-essentials
run_script_in_debian debian/install-dnsmasq
$scp -pr debian/dnsmasq.d/* /debian/etc/dnsmasq.d/
run_script_in_debian debian/install-mysql "$password"
run_script_in_debian debian/install-tomcat "$password"
