#!/bin/bash

# This package installation takes place in the yocto environment. It disables
# hostap and udhcp daemons and will undo the configuration created in the
# preinst script. Finally it signals apt that it requires a boot.
set -e
cat <<EOF | buendia-enter-yocto
systemctl disable hostapd
systemctl stop hostapd
sed -i /etc/hostapd/hostapd.conf \
  -e "s/.*# Added by buendia//"
sed -i /etc/hostapd/udhcpd-for-hostapd.conf \
  -e "s/.*# Added by buendia//"
EOF
# Indicate a reboot is required
touch /var/run/reboot-required
