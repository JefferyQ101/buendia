#!/bin/sh
### BEGIN INIT INFO
# Provides: buendia-warmup
# Required-Start: $all
# Required-Stop:
# Should-Start:
# Default-Start: 2 3 4 5
# Default-Stop: 0 1 6
# Short-Description: Warms up the Buendia server once on boot.
# Description: Makes HTTP requests to the Buendia server until it comes up.
### END INIT INFO

PATH=/sbin:/usr/sbin:/bin:/usr/bin

case "$1" in
    start|restart|'')
        /usr/bin/buendia-warmup -r localhost:9000 || service tomcat7 restart
        ;;

    stop)
        # Nothing to do on shutdown.
        ;;

    *)
        echo "Usage: buendia-warmup [start|restart|stop]" >&2
        exit 3
        ;;
esac
